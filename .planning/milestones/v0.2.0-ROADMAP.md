# Milestone v0.2.0: Pre-commit Framework

**Status:** SHIPPED 2026-02-09
**Phases:** 5
**Total Plans:** 1

## Overview

Migrated from legacy bash git hooks to the pre-commit framework, with declarative `.pre-commit-config.yaml` calling `make check` as the single source of truth. Conventional commit message validation via maintained external hook. Single `make bootstrap` command installs all dev dependencies and git hooks.

## Phases

### Phase 5: Pre-commit Framework Migration

**Goal**: Pre-commit framework replaces legacy bash hooks for quality enforcement.
**Depends on**: v0.1.0 foundation (Makefile check target, pyproject.toml dev dependencies)
**Plans**: 1 plan

Plans:

- [x] 05-01: Install pre-commit framework, create .pre-commit-config.yaml, update bootstrap, remove legacy hooks

**Details:**

- Created `.pre-commit-config.yaml` with two hooks:
  - `make-check`: local hook calling `make check` with `language: system`, `pass_filenames: false`, `always_run: true`, `verbose: true`
  - `conventional-pre-commit`: external hook from compilerla/conventional-pre-commit@v4.3.0 on commit-msg stage
- Added `pre-commit>=4.5.1` to pyproject.toml dev dependencies
- Updated Makefile bootstrap target: `uv run pre-commit install` replaces legacy hook copying
- Configured `default_install_hook_types: [pre-commit, commit-msg]` for single install command
- Removed legacy `scripts/hooks/pre-commit` and `scripts/hooks/commit-msg` bash scripts

**Requirements satisfied:**
- HOOK-01: Pre-commit framework installed via `make bootstrap`
- HOOK-02: `.pre-commit-config.yaml` exists with local hook running `make check`
- HOOK-03: Commit-msg hook validates conventional commit format
- HOOK-04: Legacy `scripts/hooks/` bash scripts removed
- HOOK-05: `make bootstrap` updated to use `pre-commit install`

---

## Milestone Summary

**Decimal Phases:** None

**Key Decisions:**

- Pre-commit framework migration — reversed v0.1.0 decision for declarative hook management (Rationale: maintainability, ecosystem compatibility, automatic installation)
- `language: system` for make-check hook (Rationale: allows make check to access full project environment)
- `pass_filenames: false` (Rationale: Make discovers files itself via glob patterns)
- `always_run: true` (Rationale: make check should run on every commit regardless of changed files)
- `conventional-pre-commit` external hook (Rationale: maintained hook instead of hand-rolled regex validation)
- `default_install_hook_types: [pre-commit, commit-msg]` (Rationale: single install command for both hook types)

**Issues Resolved:**

- Eliminated manual hook management — pre-commit framework handles installation and updates
- Replaced fragile bash regex commit-msg validation with maintained conventional-pre-commit

**Issues Deferred:** None

**Technical Debt Incurred:** None

---

_For current project status, see .planning/ROADMAP.md_
